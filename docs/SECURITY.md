# Безопасность

## Админ-команды

Команды `/broadcast`, `/users`, `/logs`, `/health` доступны **только пользователям из списка администраторов**.

- Список задаётся в `.env`: **`ADMIN_IDS`** — перечисление Telegram ID через запятую (например, `123456789,987654321`).
- Проверка выполняется в `handlers/admin.py`: перед выполнением каждой админ-команды вызывается `is_admin(user_id)` (сравнение с `config.ADMIN_IDS`).
- **Рекомендация:** задайте `ADMIN_IDS` в продакшене и не коммитьте `.env` в репозиторий.

## Секреты и конфигурация

- **Секреты только в окружении:** токен бота, API-ключи (Artemox, OpenAI, DeepSeek и т.д.) задаются через переменные окружения и `.env`. Файл `.env` должен быть в `.gitignore`.
- **Валидация при старте:** обязательные переменные `TELEGRAM_BOT_TOKEN` и `ARTEMOX_API_KEY` проверяются при импорте `config` (pydantic-settings); при отсутствии процесс завершается с понятным сообщением.
- Не храните ключи в коде и не логируйте их (structlog и логи не должны содержать токены).

## Веб-админка и пароль

- Пароль веб-админки (если используется) задаётся переменной **`ADMIN_PANEL_PASSWORD`** в `.env`. Пустое значение означает запуск без защиты — в продакшене задайте надёжный пароль или ограничьте доступ по сети.

## Health и метрики

- **GET /health** и **GET /metrics** на порту `METRICS_PORT` (9090) не аутентифицируются — предназначены для liveness-проверок и Prometheus внутри доверенной сети. Не открывайте этот порт в интернет без необходимости.
